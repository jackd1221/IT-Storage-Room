<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Check Out an Item</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; }
    label { display: block; margin-top: 10px; }
    select, input { width: 100%; padding: 8px; margin-top: 4px; }
    .button-group { margin-top: 20px; }
    button { padding: 10px 20px; margin-right: 10px; }
    .tab-container { margin-bottom: 20px; }
    .tab-button { padding: 8px 16px; cursor: pointer; margin-right: 5px; }
    .tab-button.active { background-color: #007bff; color: white; }
  </style>
</head>
<body>

  <h1 style="text-align: center;">Check Out an Item</h1>

  <div class="tab-container">
    <button class="tab-button active" onclick="switchRoom('main')">Main Room</button>
    <button class="tab-button" onclick="switchRoom('second')">Second Room</button>
  </div>

  <form id="checkout-form">
    <label for="item">Item:</label>
    <select id="item" name="item" required>
      <!-- Populated dynamically -->
    </select>

    <label for="quantity">Quantity:</label>
    <input type="number" id="quantity" name="quantity" min="1" value="1" required />

    <label for="user">Name:</label>
    <input type="text" id="user" name="user" required />

    <label for="location">Location:</label>
    <select id="location" name="location" required>
      <option value="">--Select Location--</option>
      <option value="LaVernge">LaVernge</option>
      <option value="Off-Site Pre School">Off-Site Pre School</option>
      <option value="Out Of District">Out Of District</option>
      <option value="Emerson">Emerson</option>
      <option value="Piper">Piper</option>
      <option value="Pershing">Pershing</option>
      <option value="Irving">Irving</option>
      <option value="Hiawatha">Hiawatha</option>
      <option value="Komensky">Komensky</option>
      <option value="Freedom">Freedom</option>
      <option value="Heritage">Heritage</option>
      <option value="Other">Other</option>
    </select>

    <label for="action">Action:</label>
    <select id="action" name="action" required>
      <option value="checkout">Check Out</option>
      <option value="checkin">Check In</option>
    </select>

    <div class="button-group">
      <button type="submit">Submit</button>
      <button type="button" id="clear-btn">Clear</button>
    </div>
  </form>

  <script>
    const form = document.getElementById("checkout-form");
    const itemSelect = document.getElementById("item");
    let currentRoom = "main";

    const itemsByRoom = {
      main: [
        "iPad Elementary",
        "iPad Middle",
        "Keyboard iPad Case",
        "iPad Case",
        "New iPad Charging Block",
        "Old iPad Charging Block",
        "MacBook",
        "MacBook Charging Block",
        "Apple TV",
        "USB C to USB C",
        "USB A to USB C",
        "Charging Station"
      ],
      second: [
        "XLR Cable",
        "Microphone",
        "Ethernet Cable"
      ]
    };

    function populateItems(room) {
      itemSelect.innerHTML = '<option value="">--Select Item--</option>';
      itemsByRoom[room].forEach(item => {
        const option = document.createElement("option");
        option.value = item;
        option.textContent = item;
        itemSelect.appendChild(option);
      });
    }

    function switchRoom(room) {
      currentRoom = room;
      populateItems(room);
      document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
      document.querySelector(`[onclick="switchRoom('${room}')"]`).classList.add("active");
    }

    form.addEventListener("submit", async e => {
      e.preventDefault();

      const data = {
        room: currentRoom,
        item: form.item.value,
        quantity: form.quantity.value,
        user: form.user.value,
        location: form.location.value,
        action: form.action.value
      };

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbxG0iAwR-lXRmOnMWY-Gq8xnAeuhwChPjnYyurdN3w_WlX-5q-EECIOya0QbSrYqtmghg/exec", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          mode: "cors",
          body: JSON.stringify(data)
        });

        const text = await response.text();
        alert(text);
        form.reset();
        populateItems(currentRoom);
      } catch (err) {
        alert("Error submitting form: " + err.message);
        console.error(err);
      }
    });

    document.getElementById("clear-btn").addEventListener("click", () => {
      form.reset();
      populateItems(currentRoom);
    });

    // Initialize form with main room items
    populateItems(currentRoom);
  </script>

</body>
</html>
